<!DOCTYPE html>
<html lang="en-GB" class="no-js">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="profile" href="https://gmpg.org/xfn/11">

    <title>
      {%- if page.url == "/" -%}
        {{ metadata.title }}
      {%- else -%}
        {{ title + " | " + metadata.author.name }}
      {%- endif -%}
    </title>

    <meta name="description" content="{{ description or metadata.description }}">
    <meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>

    <link rel="canonical" href="{{ metadata.url }}{{ page.url | url }}" />

    <meta property="og:locale" content="en_GB" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="{{ title or metadata.title }}" />
    <meta property="og:description" content="{{ description or metadata.description }}" />
    <meta property="og:url" content="{{ metadata.url }}{{ page.url | url }}" />
    <meta property="og:site_name" content="{{ metadata.author.name }}" />
    {# <meta property="og:image" content="/assets/img/me-profile.jpg"> #}

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{{ title or metadata.title }}">
    <meta name="twitter:description" content="{{ description or metadata.title }}">
    {# <meta name="twitter:image" content="/assets/img/me-profile.jpg"> #}

    {%- set css %}
      {% include "../../assets/css/critical.css" %}
    {% endset -%}
    {% if css %}
    <style>
      /* Critical CSS */
      {{ css | cssmin | safe }}
    </style>
    {% endif %}

    <link href="https://fonts.googleapis.com/css?family=Karla:400,700|Quicksand:400,700" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">

  </head>

  <body id="start"
    {%- if page.url == "/" %} class="home"
    {%- elseif "work" | urlmatch(page.url) %} data-theme="{{page.fileSlug}}"
    {%- endif -%}
  >

	  <a class="skip-link screen-reader-text" href="#content">Skip to content</a>

    {% include "components/header.njk" %}

    <main>
      {{ content | safe }}
    </main>

    {% include "components/footer.njk" %}

    {% set js %}

    {% include "../../assets/js/app.js" %}
    
    var faqs = document.querySelector('dl.faqs');
    if (faqs) {
      faqs.addEventListener('click', function(e) {
        if (e.target.tagName === "DT") {
          var question = e.target;
          var answer = question.nextElementSibling;
          answer.style.display === 'block' ? answer.style.display = 'none' : answer.style.display = 'block';
        }
      });
    }

    {% if page.url | url == "/contact/" %}
    let contactForm = document.querySelector("#contact-form");

    if (contactForm) {
      contactForm.addEventListener('submit', e => {
        e.preventDefault();
        const formData = new FormData(contactForm);
        fetch(contactForm.getAttribute('action'), {
          method: 'POST',
          headers: {
            'Accept': 'application/x-www-form-urlencoded;charset=UTF-8',
            'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'
          },
          body: new URLSearchParams(formData).toString()
        })
        .then(res => {
          if (res) {
            contactForm.innerHTML = '<div class="w-centre" role="alert"><h2>Message sent</h2><p><strong>Thank you for your enquiry. I will get back to you ASAP.</strong></p></div>';
          }
        });
      });
    }
    {% endif %}
    {% endset %}
    <script>
      document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );
      {{ js | jsmin | safe }}
    </script>
  </body>
</html>
